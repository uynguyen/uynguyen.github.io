<!doctype html>
<html lang="vi"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Lập Trình Bất Đồng Bộ trong Swift - Uy Nguyen</title><meta description="Promise Kit, một trong những framework tốt nhất để xử lý lập trình bất đồng bộ trong Swift  Trong bài viết này, tôi sẽ sử dụng các thư viện bên thứ ba sau để hoàn thành dự án:  Alamofire: Một framewo"><meta property="og:type" content="blog"><meta property="og:title" content="Lập Trình Bất Đồng Bộ trong Swift"><meta property="og:url" content=":year/:month/:day/:title/"><meta property="og:site_name" content="Uy Nguyen"><meta property="og:description" content="Promise Kit, một trong những framework tốt nhất để xử lý lập trình bất đồng bộ trong Swift  Trong bài viết này, tôi sẽ sử dụng các thư viện bên thứ ba sau để hoàn thành dự án:  Alamofire: Một framewo"><meta property="og:locale" content="vi_VN"><meta property="article:published_time" content="2018-01-16T14:32:45.000Z"><meta property="article:modified_time" content="2026-01-26T06:49:48.783Z"><meta property="article:author" content="Uy Nguyen"><meta property="article:tag" content="Swift"><meta property="article:tag" content="iOS"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/Post-Resources/PromiseKIT/PromiseKIT.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://uynguyen.github.io/vi/posts/Asynchronous-Programming-in-Swift/index.html"},"headline":"Uy Nguyen","image":["https://uynguyen.github.io/Post-Resources/PromiseKIT/PromiseKIT.png","https://uynguyen.github.io/Post-Resources/PromiseKIT/CallbackHell.png","https://uynguyen.github.io/Post-Resources/PromiseKIT/PromiseKitDemo.gif"],"datePublished":"2018-01-16T14:32:45.000Z","dateModified":"2026-01-26T06:49:48.783Z","author":{"@type":"Person","name":"Uy Nguyen"},"description":"Promise Kit, một trong những framework tốt nhất để xử lý lập trình bất đồng bộ trong Swift  Trong bài viết này, tôi sẽ sử dụng các thư viện bên thứ ba sau để hoàn thành dự án:  Alamofire: Một framewo"}</script><link rel="canonical" href="https://uynguyen.github.io/vi/posts/Asynchronous-Programming-in-Swift/index.html"><link rel="icon" href="/Post-Resources/UyNguyen.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><meta property="og:image" content="/Post-Resources/PromiseKIT/PromiseKIT.png"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-163508356-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-163508356-1');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/Post-Resources/UyNguyen.jpg" alt="Uy Nguyen" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><div class="navbar-item has-dropdown is-hoverable language-switcher is-hidden-mobile"><a class="navbar-link" title="Language"><i class="fas fa-globe"></i></a><div class="navbar-dropdown is-right"><a class="navbar-item" href="/2018/01/16/Asynchronous-Programming-in-Swift/">English</a><a class="navbar-item is-active" href="/vi/posts/Asynchronous-Programming-in-Swift/">Tiếng Việt</a><a class="navbar-item" href="/es/posts/Asynchronous-Programming-in-Swift/">Español</a></div></div><a class="navbar-item search is-hidden-mobile" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><div class="mobile-toolbar is-hidden-tablet"><div class="container"><div class="mobile-toolbar-content"><button class="mobile-toolbar-btn" id="mobile-lang-btn" title="Language"><i class="fas fa-globe"></i><span>Tiếng Việt</span></button><button class="mobile-toolbar-btn search" title="Search"><i class="fas fa-search"></i><span>Search</span></button></div></div></div><div class="language-picker-overlay" id="lang-picker-overlay"><div class="language-picker-backdrop"></div><div class="language-picker-modal"><div class="language-picker-header"><span>Language</span><button class="language-picker-close" id="lang-picker-close"><i class="fas fa-times"></i></button></div><div class="language-picker-options"><a class="language-picker-option" href="/2018/01/16/Asynchronous-Programming-in-Swift/"><span class="lang-name">English</span></a><a class="language-picker-option is-active" href="/vi/posts/Asynchronous-Programming-in-Swift/"><span class="lang-name">Tiếng Việt</span><i class="fas fa-check"></i></a><a class="language-picker-option" href="/es/posts/Asynchronous-Programming-in-Swift/"><span class="lang-name">Español</span></a></div></div></div><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"></div></div><h1 class="title is-3 is-size-4-mobile">Lập Trình Bất Đồng Bộ trong Swift</h1><div class="content"><p><img src="/Post-Resources/PromiseKIT/PromiseKIT.png" alt=""></p>
<center>Promise Kit, một trong những framework tốt nhất để xử lý lập trình bất đồng bộ trong Swift</center>

<p>Trong bài viết này, tôi sẽ sử dụng các thư viện bên thứ ba sau để hoàn thành dự án:</p>
<ul>
<li><a href="https://github.com/Alamofire/Alamofire">Alamofire</a>: Một framework HTTP networking trong Swift.</li>
<li><a href="https://github.com/SwiftyJSON/SwiftyJSON">SwiftyJSON</a>: Để xử lý dữ liệu JSON.</li>
<li><a href="https://github.com/bahlo/SwiftGif">SwiftGifOrigin</a>: Một extension UIImage để hiển thị file Gif.</li>
<li><a href="https://github.com/BoltsFramework/Bolts-Swift">Bolts-Swift</a>: Được thiết kế bởi Parse và Facebook, tôi sử dụng nó để tạo các phương thức bất đồng bộ.</li>
<li><a href="https://github.com/mxcl/PromiseKit">PromiseKit</a>: Một framework giúp chúng ta đơn giản hóa lập trình bất đồng bộ.<br /></li>
<li><a href="https://giphy.com">API của Giphy</a> để tìm kiếm và tải ảnh gif.<a id="more"></a>
<h2 id="Bat-dau"><a href="#Bat-dau" class="headerlink" title="Bắt đầu"></a>Bắt đầu</h2></li>
</ul>
<p>Các phương thức bất đồng bộ, (viết tắt là Async), là các phương thức không trả về kết quả ngay lập tức như hầu hết các phương thức, các phương thức async mất một thời gian để tạo ra kết quả.<br>Tôi thường sử dụng callback để xử lý các phương thức bất đồng bộ như quét thiết bị Bluetooth hoặc lấy một số tài nguyên từ internet. Thực tế, callback là một kỹ thuật lập trình không tốt. Callback sẽ làm code của chúng ta khó đọc, khó debug và tốn nhiều thời gian hơn để bảo trì sau này. Cuối cùng, code của chúng ta sẽ biến thành thứ mà chúng ta gọi là callback hell.<br>Trong bài viết này, tôi sẽ tạo một dự án sử dụng từng kỹ thuật một để giải thích tại sao tôi nói callback là không tốt.<br>Đầu tiên, hãy tiếp tục và tạo một dự án, đặt tên tùy ý, sau đó cài đặt các Pod framework này vào dự án của bạn. Bạn cũng cần chỉnh sửa key <code>NSAllowsArbitraryLoads</code> thành <code>YES</code> trong dictionary <code>NSAppTransportSecurity</code> trong file info.plist để chỉ định domain nào được miễn trừ khỏi các quy tắc bạn định nghĩa cho App Transport Security. Trong trường hợp của chúng ta, đây là domain giphy.</p>
<p>Cho phép request HTTP chỉ cho domain giphy</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">    &lt;key&gt;NSExceptionDomains&lt;/key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">        &lt;key&gt;api.giphy.com&lt;/key&gt;</span><br><span class="line">        &lt;dict&gt;</span><br><span class="line">            &lt;key&gt;NSExceptionAllowsInsecureHTTPLoads&lt;/key&gt;</span><br><span class="line">            &lt;<span class="literal">true</span>/&gt;</span><br><span class="line">        &lt;/dict&gt;</span><br><span class="line">    &lt;/dict&gt;</span><br><span class="line">&lt;/dict&gt;</span><br></pre></td></tr></table></figure>

<p>Hoặc cho phép request HTTP cho tất cả domain, đây không phải là một ý tưởng tốt.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">    &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span><br><span class="line">    &lt;<span class="literal">true</span>/&gt;</span><br><span class="line">&lt;/dict&gt;</span><br></pre></td></tr></table></figure>

<p>Hãy tạo một class có tên <code>ImageLoader</code>. Class này chứa hai phương thức giúp chúng ta tìm kiếm và tải ảnh gif từ server Giphy.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ImageLoader.swift</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageLoader</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Tìm kiếm ảnh khớp với keyword trên server Giphy</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Tải ảnh tại url</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Phien-ban-dau-tien-Su-dung-callback"><a href="#Phien-ban-dau-tien-Su-dung-callback" class="headerlink" title="Phiên bản đầu tiên: Sử dụng callback"></a>Phiên bản đầu tiên: Sử dụng callback</h2><p>Đầu tiên, chúng ta cần định nghĩa hai callback, sẽ được truyền vào các phương thức <code>fetchImage</code> và <code>downloadImage</code>.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">FetchImageBlock</span> = (<span class="type">URL?</span>, <span class="type">Error?</span>) -&gt; <span class="type">Void</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">DownloadImageBlock</span> = (<span class="type">URL?</span>, <span class="type">Error?</span>) -&gt; <span class="type">Void</span></span><br></pre></td></tr></table></figure>

<p>Sau đó, chúng ta triển khai hai phương thức này:</p>
<ul>
<li><code>fetchImage</code> nhận keyword và callback làm tham số, gửi request đến server Giphy để truy vấn tất cả ảnh khớp với keyword, lấy cái đầu tiên và cuối cùng trả về url tải xuống qua callback.</li>
<li><code>downloadImage</code> nhận url và callback làm tham số, sau đó sử dụng framework <code>Alamofire</code> để tải ảnh. Cuối cùng, trả về url đích, nơi ảnh được lưu, qua callback.</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String, callback: @escaping FetchImageBlock)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> endPoint = <span class="string">"http://api.giphy.com/v1/gifs/search?q=\(keyword)&amp;limit=1&amp;api_key=q4N1oD5jw3xvH2hIOkFAyHXWTTrh0D30"</span></span><br><span class="line">    <span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="type">Alamofire</span>.request(endPoint, headers: headers).responseData &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="literal">nil</span>, error)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> jsonData = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data!)</span><br><span class="line">        <span class="keyword">let</span> dataArray = jsonData[<span class="string">"data"</span>].array</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> dataArray = dataArray, dataArray.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> imagesList = dataArray[<span class="number">0</span>][<span class="string">"images"</span>]</span><br><span class="line">            <span class="keyword">let</span> downsized_large = imagesList[<span class="string">"downsized_large"</span>][<span class="string">"url"</span>].stringValue</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="type">URL</span>.<span class="keyword">init</span>(string: downsized_large), <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="literal">nil</span>, <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL, callback: @escaping DownloadImageBlock)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> destination: <span class="type">DownloadRequest</span>.<span class="type">DownloadFileDestination</span> = &#123; <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> documentsURL = <span class="type">FileManager</span>.<span class="keyword">default</span>.urls(<span class="keyword">for</span>: .documentDirectory, <span class="keyword">in</span>: .userDomainMask)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">let</span> fileURL = documentsURL.appendingPathComponent(url.lastPathComponent)</span><br><span class="line">        <span class="keyword">return</span> (fileURL, [.removePreviousFile, .createIntermediateDirectories])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Alamofire</span>.download(url, to: destination).downloadProgress(closure: &#123; (progress) <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\(progress)"</span>)</span><br><span class="line">    &#125;).responseData(completionHandler: &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="literal">nil</span>, error)</span><br><span class="line">        &#125;</span><br><span class="line">        callback(response.destinationURL, <span class="literal">nil</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Bên trong view controller chính, hãy định nghĩa một phương thức gọi là <code>searchImageWithKeyword</code>. Phương thức này nhận keyword làm tham số, sau đó truyền tham số vào phương thức <code>fetchImage</code> của một instance của class <code>ImageLoader</code>. Chúng ta cũng cần truyền một callback để xử lý kết quả.<br>Bên trong callback <code>fetchImage</code>, hãy kiểm tra xem có lỗi nào không. Nếu có, chúng ta dừng gọi phương thức tiếp theo, <code>downloadImage</code>. Ngược lại, chúng ta gọi <code>downloadImage</code> của đối tượng <code>imageLoader</code>. Sau đó truyền url và callback làm tham số.<br>Bên trong callback <code>downloadImage</code>, hãy kiểm tra xem có lỗi nào không. Nếu có, chúng ta dừng gọi cái tiếp theo. Ngược lại, chúng ta cập nhật image view trên main view bằng cách gọi phương thức <code>updateImageAtURL</code>.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">searchImageWithKeyword</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    imageLoader.fetchImage(keyword: keyword, callback: &#123;downloadLink, error <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> downloadLink = downloadLink &#123;</span><br><span class="line">                imageLoader.downloadImage(url: downloadLink, callback: &#123;downloadedURL, error <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">let</span> downloadedURL = downloadedURL &#123;</span><br><span class="line">                            <span class="keyword">self</span>.updateImageAtURL(url: downloadedURL)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">"Error: downloadedURL is nil"</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Error: downloadLink is nil"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateImageAtURL</span><span class="params">(url: URL)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="type">Thread</span>.isMainThread <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            <span class="keyword">self</span>.updateImageAtURL(url: url)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> data = <span class="keyword">try</span> <span class="type">Data</span>.<span class="keyword">init</span>(contentsOf: url)</span><br><span class="line">        <span class="keyword">self</span>.imgImage.image = <span class="type">UIImage</span>.gif(data: data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Như bạn thấy, <code>searchImageWithKeyword</code> khá phức tạp với nhiều câu lệnh <code>if</code> và <code>else</code> bên trong phương thức. Chúng ta phải kiểm tra lỗi trong nhiều dòng code. Hãy tưởng tượng nó sẽ phức tạp như thế nào nếu chúng ta có nhiều hơn ba phương thức bên trong nó?</p>
<p><img src="/Post-Resources/PromiseKIT/CallbackHell.png" alt=""></p>
<center>Một callback hell trong ngôn ngữ khác, Javascript</center>

<p>Build và chạy dự án. Nhập keyword bạn muốn tìm kiếm trên server Giphy, nhấn nút tìm kiếm và bạn sẽ thấy kết quả đầu tiên.<br><img src="/Post-Resources/PromiseKIT/PromiseKitDemo.gif" width="300"></p>
<center>Dự án lập trình async</center>

<h2 id="Giai-phap-tot-hon-Su-dung-Bolts"><a href="#Giai-phap-tot-hon-Su-dung-Bolts" class="headerlink" title="Giải pháp tốt hơn: Sử dụng Bolts"></a>Giải pháp tốt hơn: Sử dụng Bolts</h2><p>Bolts là một framework được thiết kế bởi Parse và Facebook, tôi sử dụng nó để tạo các phương thức bất đồng bộ, mà không sử dụng callback. Framework Bolts cho phép chúng ta viết code như một chuỗi các hành động dựa trên các sự kiện.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String)</span></span> -&gt; <span class="type">Task</span>&lt;<span class="type">URL</span>&gt;! &#123;</span><br><span class="line">    <span class="keyword">let</span> mainTask = <span class="type">TaskCompletionSource</span>&lt;<span class="type">URL</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> endPoint = <span class="string">"http://api.giphy.com/v1/gifs/search?q=\(keyword)&amp;limit=1&amp;api_key=q4N1oD5jw3xvH2hIOkFAyHXWTTrh0D30"</span></span><br><span class="line">    <span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="type">Alamofire</span>.request(endPoint, headers: headers).responseData &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: error)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> jsonData = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data!)</span><br><span class="line">        <span class="keyword">let</span> dataArray = jsonData[<span class="string">"data"</span>].array</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> dataArray = dataArray, dataArray.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> imagesList = dataArray[<span class="number">0</span>][<span class="string">"images"</span>]</span><br><span class="line">            <span class="keyword">let</span> fixed_height_still = imagesList[<span class="string">"downsized_large"</span>][<span class="string">"url"</span>].stringValue</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(result: <span class="type">URL</span>.<span class="keyword">init</span>(string: fixed_height_still)!)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: <span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mainTask.task</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL)</span></span> -&gt; <span class="type">Task</span>&lt;<span class="type">URL</span>&gt;! &#123;</span><br><span class="line">    <span class="keyword">let</span> mainTask = <span class="type">TaskCompletionSource</span>&lt;<span class="type">URL</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> destination: <span class="type">DownloadRequest</span>.<span class="type">DownloadFileDestination</span> = &#123; <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> documentsURL = <span class="type">FileManager</span>.<span class="keyword">default</span>.urls(<span class="keyword">for</span>: .documentDirectory, <span class="keyword">in</span>: .userDomainMask)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">let</span> fileURL = documentsURL.appendingPathComponent(url.lastPathComponent)</span><br><span class="line">        <span class="keyword">return</span> (fileURL, [.removePreviousFile, .createIntermediateDirectories])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Alamofire</span>.download(url, to: destination).downloadProgress(closure: &#123; (progress) <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\(progress)"</span>)</span><br><span class="line">    &#125;).responseData(completionHandler: &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: error)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> destinationURL = response.destinationURL &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(result: destinationURL)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: <span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> mainTask.task</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Hãy xem <code>searchImageWithKeyword</code> sẽ đơn giản như thế nào khi sử dụng Bolts.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">searchImageWithKeyword</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    imageLoader.fetchImage(keyword: keyword).continueOnSuccessWith &#123; (linkDownload) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        imageLoader.downloadImage(url: linkDownload).continueOnSuccessWith(continuation: &#123; (downloadedURL) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.updateImageAtURL(url: downloadedURL)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;.continueOnErrorWith &#123; (error) <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Build và chạy dự án, không có gì thay đổi. Nhưng code dễ đọc hơn cái đầu tiên, phải không? Chúng ta tập hợp tất cả lỗi ở một nơi, cũng tách biệt việc xử lý lỗi và code thành công.</p>
<h2 id="Giai-phap-tot-hon-nhieu-Su-dung-PromiseKit"><a href="#Giai-phap-tot-hon-nhieu-Su-dung-PromiseKit" class="headerlink" title="Giải pháp tốt hơn nhiều: Sử dụng PromiseKit"></a>Giải pháp tốt hơn nhiều: Sử dụng PromiseKit</h2><p>Một điều tôi không thích về framework Bolts là thiếu tài liệu và dự án mẫu. Khi tôi lần đầu sử dụng framework Bolts, tôi rất khó làm quen với các API của đối tượng Task.<br>Tại <a href="https://uynguyen.github.io/2017/11/29/Swift-Summit-conference-in-San-Francisco-2017/">hội nghị Swift Summit 2017</a>, có một diễn giả đã giới thiệu một Framework để xử lý các phương thức async, PromiseKit. Sau hội nghị, tôi đã thay thế code sử dụng framework Bolts bằng PromiseKit trong các dự án của công ty tôi. Tôi nhận ra code của tôi bây giờ dễ đọc hơn. Tôi nghĩ cách viết của PromiseKit sẽ quen thuộc hơn với các developer so với cách viết của Bolts, đặc biệt là những người đã làm việc với Javascript như tôi.<br>Một phương thức async được tạo bằng PromiseKit trả về một Promise generic mới, đây là class chính được cung cấp bởi PromiseKit. Constructor của nó nhận một khối thực thi đơn giản với hai tham số:</p>
<ul>
<li>fulfill: Một hàm để gọi khi giá trị mong muốn sẵn sàng để hoàn thành promise.</li>
<li>reject: Một hàm để gọi nếu có lỗi.</li>
</ul>
<p>Hãy áp dụng PromiseKit vào dự án của chúng ta</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String)</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">URL</span>&gt;  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Promise</span> &#123; fullfil, reject <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> endPoint = <span class="string">"http://api.giphy.com/v1/gifs/search?q=\(keyword)&amp;limit=1&amp;api_key=q4N1oD5jw3xvH2hIOkFAyHXWTTrh0D30"</span></span><br><span class="line">        <span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [</span><br><span class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="type">Alamofire</span>.request(endPoint, headers: headers).responseData &#123; (response) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">                <span class="keyword">return</span> reject(error)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> jsonData = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data!)</span><br><span class="line">            <span class="keyword">let</span> dataArray = jsonData[<span class="string">"data"</span>].array</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> dataArray = dataArray, dataArray.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> imagesList = dataArray[<span class="number">0</span>][<span class="string">"images"</span>]</span><br><span class="line">                <span class="keyword">let</span> fixed_height_still = imagesList[<span class="string">"downsized_large"</span>][<span class="string">"url"</span>].stringValue</span><br><span class="line">                <span class="keyword">return</span> fullfil(<span class="type">URL</span>.<span class="keyword">init</span>(string: fixed_height_still)!)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> reject(<span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL)</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">URL</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Promise</span> &#123; fullfil, reject <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> destination: <span class="type">DownloadRequest</span>.<span class="type">DownloadFileDestination</span> = &#123; <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> documentsURL = <span class="type">FileManager</span>.<span class="keyword">default</span>.urls(<span class="keyword">for</span>: .documentDirectory, <span class="keyword">in</span>: .userDomainMask)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">let</span> fileURL = documentsURL.appendingPathComponent(url.lastPathComponent)</span><br><span class="line">            <span class="keyword">return</span> (fileURL, [.removePreviousFile, .createIntermediateDirectories])</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Alamofire</span>.download(url, to: destination).downloadProgress(closure: &#123; (progress) <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\(progress)"</span>)</span><br><span class="line">        &#125;).responseData(completionHandler: &#123; (response) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">                <span class="keyword">return</span> reject(error)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> destinationURL = response.destinationURL &#123;</span><br><span class="line">                <span class="keyword">return</span> fullfil(destinationURL)</span><br><span class="line">            &#125;</span><br><span class="line">            reject(<span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Và kết quả cuối cùng, code đẹp làm sao! :))</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">searchImageWithKeyword</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    firstly &#123;</span><br><span class="line">        imageLoader.fetchImage(keyword: keyword)</span><br><span class="line">    &#125;.then &#123;  downloadLink -&gt; <span class="type">Promise</span>&lt;<span class="type">URL</span>&gt; <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> imageLoader.downloadImage(url: downloadLink)</span><br><span class="line">    &#125;.then &#123;downloadedURL -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">self</span>.updateImageAtURL(url: downloadedURL)</span><br><span class="line">    &#125;.<span class="keyword">catch</span> &#123; error <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Một tính năng mà tôi thấy rất thú vị trong cả hai framework, Bolts và PromiseKit, là chúng cho phép code của chúng ta chạy trên một thread nhất định (Main thread hoặc background thread). Đây là một tính năng tuyệt vời vì hầu hết công việc được thực hiện trong view controller là để cập nhật UI. Đôi khi, các tác vụ chạy lâu được xử lý tốt nhất trên background thread, để không làm nghẽn UI. Để biết thêm chi tiết về tính năng Thread này, vui lòng tham khảo tài liệu của họ: <em>#Threading</em></p>
<h2 id="Ket-luan"><a href="#Ket-luan" class="headerlink" title="Kết luận"></a>Kết luận</h2><p>Vì tôi đang làm việc với CoreBluetooth, tôi thường phải làm việc với các phương thức async. Quá nhiều callback làm dự án của tôi khó hiểu hơn và khó debug nếu có lỗi xảy ra. <code>Promise</code> làm code của tôi trở thành một cô gái đẹp hơn ;).<br>Bạn có thể tải dự án mẫu hoàn chỉnh <a href="https://github.com/uynguyen/Asynchronous-In-Swift">tại đây</a>.<br>Hãy để lại bình luận về bài viết của tôi.</p>
</div><div class="article-tags size-small is-uppercase mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/"></a><a class="link-muted mr-2" rel="tag" href="/"></a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=5e9474199d6bcc0012d5bba6&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://ko-fi.com/uynguyen" style="background-color:rgba(255,128,62,.87);border-color:transparent;color:white;" target="_blank" rel="noopener"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button is-warning donate" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="uynguyen.itus@gmail.com"><input type="hidden" name="currency_code" value="USD"></form></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://uynguyen.github.io/vi/posts/Asynchronous-Programming-in-Swift/index.html';
            this.page.identifier = 'vi/posts/Asynchronous-Programming-in-Swift/index.html';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'uynguyen-github-io' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="/Post-Resources/UyNguyen.jpg" alt="Uy Nguyen"></figure><p class="title is-size-4 is-block line-height-inherit">Uy Nguyen</p><p class="is-size-6 is-block">Software engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-envelope mr-1"></i><span>uynguyen.itus@gmail.com</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">58</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">33</p></a></div></div></nav><div class="level"><a class="level-item button is-rounded" style="background-color:#f14668e3;color:white;font-weight:bold;" href="https://ko-fi.com/uynguyen" target="_blank" rel="noopener">if 👍 then Buy me a Coffee</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/uynguyen"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://www.linkedin.com/in/uynguyen505"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://uynguyen.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Uy Nguyen</span></span><span class="level-right"><span class="level-item tag">uynguyen.github.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2025-04-02T11:03:38.000Z">2025-04-02</time></p><p class="title is-6"><a class="link-muted" href="/2025/04/02/Bluetooth-security-Implement-authentication/">Securing Bluetooth Communication: Implementing Authentication and Encryption Flows</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2024-11-03T03:33:53.000Z">2024-11-03</time></p><p class="title is-6"><a class="link-muted" href="/2024/11/03/iOS-18-What-s-news-in-CoreBluetooth/">iOS 18: What&#039;s news in CoreBluetooth?</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2024-08-31T03:38:32.000Z">2024-08-31</time></p><p class="title is-6"><a class="link-muted" href="/2024/08/31/Bluetooth-security-Pairing-and-Bonding/">Bluetooth security: Pairing and Bonding</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2024-08-04T05:10:39.000Z">2024-08-04</time></p><p class="title is-6"><a class="link-muted" href="/2024/08/04/Android-Bluetooth-A-Pitfall/">Android Bluetooth: A Pitfall</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2024-06-30T03:48:09.000Z">2024-06-30</time></p><p class="title is-6"><a class="link-muted" href="/2024/06/30/Best-practice-iOS-vs-Android-Bluetooth/">Best practice: iOS vs Android Bluetooth</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Android/"><span class="tag">Android</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Appclip/"><span class="tag">Appclip</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BLE/"><span class="tag">BLE</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bluetooth/"><span class="tag">Bluetooth</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Books/"><span class="tag">Books</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cocoa/"><span class="tag">Cocoa</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Concurrency/"><span class="tag">Concurrency</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Conference/"><span class="tag">Conference</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Core-Data/"><span class="tag">Core Data</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CoreBluetooh/"><span class="tag">CoreBluetooh</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CrossPlatform/"><span class="tag">CrossPlatform</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Design-Patterns/"><span class="tag">Design Patterns</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DispatchQueue/"><span class="tag">DispatchQueue</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Memory-management/"><span class="tag">Memory management</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Notification/"><span class="tag">Notification</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Objective-C/"><span class="tag">Objective-C</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Operations/"><span class="tag">Operations</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ReactNative/"><span class="tag">ReactNative</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Software-Architecture/"><span class="tag">Software Architecture</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Study/"><span class="tag">Study</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Swift/"><span class="tag">Swift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UI/"><span class="tag">UI</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UIStackView/"><span class="tag">UIStackView</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UML/"><span class="tag">UML</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vendor/"><span class="tag">Vendor</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WatchOS/"><span class="tag">WatchOS</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web-Bluetooth/"><span class="tag">Web Bluetooth</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/books/"><span class="tag">books</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iBeacon/"><span class="tag">iBeacon</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/study/"><span class="tag">study</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/Post-Resources/UyNguyen.jpg" alt="Uy Nguyen" height="28"></a><p class="size-small"><span>&copy; Uy Nguyen</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("vi");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://uynguyen.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>