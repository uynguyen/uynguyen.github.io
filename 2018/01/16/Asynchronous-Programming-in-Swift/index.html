<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Asynchronous Programming in Swift | Uy Nguyen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Promise Kit, one of the best frameworks to deal with asynchronous programming in Swift  In this post, I will use these following third parties to complete the project:  Alamofire: A HTTP networking f">
<meta property="og:type" content="article">
<meta property="og:title" content="Asynchronous Programming in Swift">
<meta property="og:url" content="https://uynguyen.github.io/2018/01/16/Asynchronous-Programming-in-Swift/index.html">
<meta property="og:site_name" content="Uy Nguyen">
<meta property="og:description" content="Promise Kit, one of the best frameworks to deal with asynchronous programming in Swift  In this post, I will use these following third parties to complete the project:  Alamofire: A HTTP networking f">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PromiseKIT/PromiseKIT.png">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PromiseKIT/CallbackHell.png">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PromiseKIT/PromiseKitDemo.gif">
<meta property="article:published_time" content="2018-01-16T14:32:45.000Z">
<meta property="article:modified_time" content="2024-03-23T03:54:36.080Z">
<meta property="article:author" content="Uy Nguyen">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="Swift">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://uynguyen.github.io/Post-Resources/PromiseKIT/PromiseKIT.png">
  
    <link rel="alternate" href="/atom.xml" title="Uy Nguyen" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Uy Nguyen</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Be a Software Engineer, not a Coder.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://uynguyen.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Asynchronous-Programming-in-Swift" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/16/Asynchronous-Programming-in-Swift/" class="article-date">
  <time datetime="2018-01-16T14:32:45.000Z" itemprop="datePublished">2018-01-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Asynchronous Programming in Swift
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/Post-Resources/PromiseKIT/PromiseKIT.png" alt=""></p>
<center>Promise Kit, one of the best frameworks to deal with asynchronous programming in Swift</center>

<p>In this post, I will use these following third parties to complete the project:</p>
<ul>
<li><a href="https://github.com/Alamofire/Alamofire" target="_blank" rel="noopener">Alamofire</a>: A HTTP networking framework in Swift.</li>
<li><a href="https://github.com/SwiftyJSON/SwiftyJSON" target="_blank" rel="noopener">SwiftyJSON</a>: To process JSON data.</li>
<li><a href="https://github.com/bahlo/SwiftGif" target="_blank" rel="noopener">SwiftGifOrigin</a>: An UIImage extension to display Gif files.</li>
<li><a href="https://github.com/BoltsFramework/Bolts-Swift" target="_blank" rel="noopener">Bolts-Swift</a>: Was designed by Parse and Facebook, I use it to create asynchronous methods.</li>
<li><a href="https://github.com/mxcl/PromiseKit" target="_blank" rel="noopener">PromiseKit</a>: A framework helps us to simplify asynchronous programming.<br /></li>
<li><a href="https://giphy.com" target="_blank" rel="noopener">Giphy’s APIs</a> for searching and downloading gif images.<a id="more"></a> 
<h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2></li>
</ul>
<p>Asynchronous methods, (Async for short), are the methods that not immediately returning results like most method, the async methods take some time to produce results.<br>I often use callbacks to deal with asynchronous methods like scanning Bluetooth devices or retrieving some resources from the internet. In fact, callback is a bad programming technique. Callback will make our code hard to read, hard to debug and take much more time to maintain later. In the end, our code will turn into something that we call the callback hell.<br>In this post, I will create a project using one by one technique to explain why I said callback is bad.<br>Firstly, go ahead and create a project, named it as whatever you like, then install these Pod frameworks to your project. You also need to edit the <code>NSAllowsArbitraryLoads</code> key to <code>YES</code> in <code>NSAppTransportSecurity</code> dictionary in the info.plist file to specify which domains are excepted from the rules you define for App Transport Security. In our case, this is the giphy domain.</p>
<p>Allow HTTP requests for only giphy domain</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">    &lt;key&gt;NSExceptionDomains&lt;/key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">        &lt;key&gt;api.giphy.com&lt;/key&gt;</span><br><span class="line">        &lt;dict&gt;</span><br><span class="line">            &lt;key&gt;NSExceptionAllowsInsecureHTTPLoads&lt;/key&gt;</span><br><span class="line">            &lt;<span class="literal">true</span>/&gt;</span><br><span class="line">        &lt;/dict&gt;</span><br><span class="line">    &lt;/dict&gt;</span><br><span class="line">&lt;/dict&gt;</span><br></pre></td></tr></table></figure>

<p>Or allow HTTP requests for all domains, it is not a good idea.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span><br><span class="line">&lt;dict&gt;</span><br><span class="line">    &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span><br><span class="line">    &lt;<span class="literal">true</span>/&gt;</span><br><span class="line">&lt;/dict&gt;</span><br></pre></td></tr></table></figure>

<p>Let’s create a class named <code>ImageLoader</code>. This class contains two methods that help us to fetch and download gif images from the Giphy server.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ImageLoader.swift</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageLoader</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Searching images that matched keyword on Giphy server</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Download the image at url   </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="The-first-version-Using-callback"><a href="#The-first-version-Using-callback" class="headerlink" title="The first version: Using callback"></a>The first version: Using callback</h2><p>Firstly, we need to define two callbacks, which will be passed to the <code>fetchImage</code> and <code>downloadImage</code> methods.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">FetchImageBlock</span> = (<span class="type">URL?</span>, <span class="type">Error?</span>) -&gt; <span class="type">Void</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">DownloadImageBlock</span> = (<span class="type">URL?</span>, <span class="type">Error?</span>) -&gt; <span class="type">Void</span></span><br></pre></td></tr></table></figure>

<p>Then, we implement these two methods:</p>
<ul>
<li><code>fetchImage</code> takes a keyword and a callback as params, sends a request to the Giphy server to query all images that match the keyword, gets the first one and finally returns the download url via the callback.</li>
<li><code>downloadImage</code> takes an url and a callback as params, then uses the <code>Alamofire</code> framework to download the image. Finally, returning the destination url, where the image is saved, via the callback.</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String, callback: @escaping FetchImageBlock)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> endPoint = <span class="string">"http://api.giphy.com/v1/gifs/search?q=\(keyword)&amp;limit=1&amp;api_key=q4N1oD5jw3xvH2hIOkFAyHXWTTrh0D30"</span></span><br><span class="line">    <span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="type">Alamofire</span>.request(endPoint, headers: headers).responseData &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="literal">nil</span>, error)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> jsonData = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data!)</span><br><span class="line">        <span class="keyword">let</span> dataArray = jsonData[<span class="string">"data"</span>].array</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> dataArray = dataArray, dataArray.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> imagesList = dataArray[<span class="number">0</span>][<span class="string">"images"</span>]</span><br><span class="line">            <span class="keyword">let</span> downsized_large = imagesList[<span class="string">"downsized_large"</span>][<span class="string">"url"</span>].stringValue</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="type">URL</span>.<span class="keyword">init</span>(string: downsized_large), <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="literal">nil</span>, <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL, callback: @escaping DownloadImageBlock)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> destination: <span class="type">DownloadRequest</span>.<span class="type">DownloadFileDestination</span> = &#123; <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> documentsURL = <span class="type">FileManager</span>.<span class="keyword">default</span>.urls(<span class="keyword">for</span>: .documentDirectory, <span class="keyword">in</span>: .userDomainMask)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">let</span> fileURL = documentsURL.appendingPathComponent(url.lastPathComponent)</span><br><span class="line">        <span class="keyword">return</span> (fileURL, [.removePreviousFile, .createIntermediateDirectories])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">Alamofire</span>.download(url, to: destination).downloadProgress(closure: &#123; (progress) <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\(progress)"</span>)</span><br><span class="line">    &#125;).responseData(completionHandler: &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> callback(<span class="literal">nil</span>, error)</span><br><span class="line">        &#125;</span><br><span class="line">        callback(response.destinationURL, <span class="literal">nil</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Inside the main view controller, let’s define a method called <code>searchImageWithKeyword</code>. This method takes a keyword as a param, then pass the param to the <code>fetchImage</code> method of an instance of the <code>ImageLoader</code> class. We also need to pass a callback to handle the results.<br>Inside the <code>fetchImage</code> callback, let’s check if there are any errors. If it is, then we stop calling the next method, <code>downloadImage</code>. Otherwise, we call the <code>downloadImage</code> of the <code>imageLoader</code> object. Then pass the url and a callback as params.<br>Inside the <code>downloadImage</code> callback, let’s check if there are any errors. If it is, then we stop calling the next one. Otherwise, we update the image view on the main view by calling the <code>updateImageAtURL</code> method.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">searchImageWithKeyword</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    imageLoader.fetchImage(keyword: keyword, callback: &#123;downloadLink, error <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> downloadLink = downloadLink &#123;</span><br><span class="line">                imageLoader.downloadImage(url: downloadLink, callback: &#123;downloadedURL, error <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">let</span> downloadedURL = downloadedURL &#123;</span><br><span class="line">                            <span class="keyword">self</span>.updateImageAtURL(url: downloadedURL)</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">"Error: downloadedURL is nil"</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Error: downloadLink is nil"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateImageAtURL</span><span class="params">(url: URL)</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="type">Thread</span>.isMainThread <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            <span class="keyword">self</span>.updateImageAtURL(url: url)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> data = <span class="keyword">try</span> <span class="type">Data</span>.<span class="keyword">init</span>(contentsOf: url)</span><br><span class="line">        <span class="keyword">self</span>.imgImage.image = <span class="type">UIImage</span>.gif(data: data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, the <code>searchImageWithKeyword</code> is quite complex with many <code>if</code> and <code>else</code> statements inside the method. We have to check errors in many lines of codes. Imagine how complex it would be if we had more than three methods inside itself? </p>
<p><img src="/Post-Resources/PromiseKIT/CallbackHell.png" alt=""></p>
<center>A callback hell in another language, Javascript</center>

<p>Build and run the project. Enter a keyword you want to search on the Giphy server, press search button then you will see the first result.<br><img src="/Post-Resources/PromiseKIT/PromiseKitDemo.gif" width="300"></p>
<center>The async programming project</center>

<h2 id="A-better-solution-Using-Bolts"><a href="#A-better-solution-Using-Bolts" class="headerlink" title="A better solution: Using Bolts"></a>A better solution: Using Bolts</h2><p>Bolts is a framework that was designed by Parse and Facebook, I use it to create asynchronous methods, without using callback. Bolts framework lets we write code as a series of actions based on events.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String)</span></span> -&gt; <span class="type">Task</span>&lt;<span class="type">URL</span>&gt;! &#123;</span><br><span class="line">    <span class="keyword">let</span> mainTask = <span class="type">TaskCompletionSource</span>&lt;<span class="type">URL</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> endPoint = <span class="string">"http://api.giphy.com/v1/gifs/search?q=\(keyword)&amp;limit=1&amp;api_key=q4N1oD5jw3xvH2hIOkFAyHXWTTrh0D30"</span></span><br><span class="line">    <span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="type">Alamofire</span>.request(endPoint, headers: headers).responseData &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: error)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> jsonData = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data!)</span><br><span class="line">        <span class="keyword">let</span> dataArray = jsonData[<span class="string">"data"</span>].array</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> dataArray = dataArray, dataArray.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> imagesList = dataArray[<span class="number">0</span>][<span class="string">"images"</span>]</span><br><span class="line">            <span class="keyword">let</span> fixed_height_still = imagesList[<span class="string">"downsized_large"</span>][<span class="string">"url"</span>].stringValue</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(result: <span class="type">URL</span>.<span class="keyword">init</span>(string: fixed_height_still)!)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: <span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mainTask.task</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL)</span></span> -&gt; <span class="type">Task</span>&lt;<span class="type">URL</span>&gt;! &#123;</span><br><span class="line">    <span class="keyword">let</span> mainTask = <span class="type">TaskCompletionSource</span>&lt;<span class="type">URL</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> destination: <span class="type">DownloadRequest</span>.<span class="type">DownloadFileDestination</span> = &#123; <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> documentsURL = <span class="type">FileManager</span>.<span class="keyword">default</span>.urls(<span class="keyword">for</span>: .documentDirectory, <span class="keyword">in</span>: .userDomainMask)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">let</span> fileURL = documentsURL.appendingPathComponent(url.lastPathComponent)</span><br><span class="line">        <span class="keyword">return</span> (fileURL, [.removePreviousFile, .createIntermediateDirectories])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Alamofire</span>.download(url, to: destination).downloadProgress(closure: &#123; (progress) <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"\(progress)"</span>)</span><br><span class="line">    &#125;).responseData(completionHandler: &#123; (response) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: error)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> destinationURL = response.destinationURL &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(result: destinationURL)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> mainTask.<span class="keyword">set</span>(error: <span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> mainTask.task</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Let’s see how simple the <code>searchImageWithKeyword</code> would be by using Bolts.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">searchImageWithKeyword</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    imageLoader.fetchImage(keyword: keyword).continueOnSuccessWith &#123; (linkDownload) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        imageLoader.downloadImage(url: linkDownload).continueOnSuccessWith(continuation: &#123; (downloadedURL) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.updateImageAtURL(url: downloadedURL)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;.continueOnErrorWith &#123; (error) <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Build and run the project, nothing changed. But the code is more readable than the first one, isn’t it? We gather all the errors in one place, also separate error handling and success code. </p>
<h2 id="A-much-better-solution-Using-PromiseKit"><a href="#A-much-better-solution-Using-PromiseKit" class="headerlink" title="A much better solution: Using PromiseKit"></a>A much better solution: Using PromiseKit</h2><p>One thing I do not like about Bolts framework is the lack of documentation and example projects. When I first use Bolts framework, I was very hard to get used to with the APIs of the Task object.<br>At the <a href="https://uynguyen.github.io/2017/11/29/Swift-Summit-conference-in-San-Francisco-2017/">Swift Summit conference 2017</a>, there was one speaker introduced a Framework to deal with async methods, PromiseKit. After the conference, I replaced the code using Bolts framework by PromiseKit at the projects in my company. I realize my code now more readable. I think PromiseKit’s writing will be more familiar to developers than Bolts’s writing, especially those who have worked with Javascript like me.<br>An async method created by using PromiseKit returns a new generic Promise, which is the primary class provided by PromiseKit. Its constructor takes a simple execution block with two parameters:</p>
<ul>
<li>fulfill: A function to call when the desired value is ready to fulfill the promise.</li>
<li>reject: A function to call if there is an error.</li>
</ul>
<p>Let’s apply PromiseKit to our project</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchImage</span><span class="params">(keyword: String)</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">URL</span>&gt;  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Promise</span> &#123; fullfil, reject <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> endPoint = <span class="string">"http://api.giphy.com/v1/gifs/search?q=\(keyword)&amp;limit=1&amp;api_key=q4N1oD5jw3xvH2hIOkFAyHXWTTrh0D30"</span></span><br><span class="line">        <span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [</span><br><span class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span></span><br><span class="line">        ]</span><br><span class="line">        <span class="type">Alamofire</span>.request(endPoint, headers: headers).responseData &#123; (response) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">                <span class="keyword">return</span> reject(error)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> jsonData = <span class="type">JSON</span>.<span class="keyword">init</span>(data: response.data!)</span><br><span class="line">            <span class="keyword">let</span> dataArray = jsonData[<span class="string">"data"</span>].array</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> dataArray = dataArray, dataArray.<span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> imagesList = dataArray[<span class="number">0</span>][<span class="string">"images"</span>]</span><br><span class="line">                <span class="keyword">let</span> fixed_height_still = imagesList[<span class="string">"downsized_large"</span>][<span class="string">"url"</span>].stringValue</span><br><span class="line">                <span class="keyword">return</span> fullfil(<span class="type">URL</span>.<span class="keyword">init</span>(string: fixed_height_still)!)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> reject(<span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadImage</span><span class="params">(url: URL)</span></span> -&gt; <span class="type">Promise</span>&lt;<span class="type">URL</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Promise</span> &#123; fullfil, reject <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> destination: <span class="type">DownloadRequest</span>.<span class="type">DownloadFileDestination</span> = &#123; <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> documentsURL = <span class="type">FileManager</span>.<span class="keyword">default</span>.urls(<span class="keyword">for</span>: .documentDirectory, <span class="keyword">in</span>: .userDomainMask)[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">let</span> fileURL = documentsURL.appendingPathComponent(url.lastPathComponent)</span><br><span class="line">            <span class="keyword">return</span> (fileURL, [.removePreviousFile, .createIntermediateDirectories])</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">Alamofire</span>.download(url, to: destination).downloadProgress(closure: &#123; (progress) <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"\(progress)"</span>)</span><br><span class="line">        &#125;).responseData(completionHandler: &#123; (response) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error = response.error &#123;</span><br><span class="line">                <span class="keyword">return</span> reject(error)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> destinationURL = response.destinationURL &#123;</span><br><span class="line">                <span class="keyword">return</span> fullfil(destinationURL)</span><br><span class="line">            &#125;</span><br><span class="line">            reject(<span class="type">NSError</span>.<span class="keyword">init</span>(domain: <span class="string">"myDomain"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And the final result, what a beautiful code! :))</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">searchImageWithKeyword</span><span class="params">(keyword: String)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    firstly &#123;</span><br><span class="line">        imageLoader.fetchImage(keyword: keyword)</span><br><span class="line">    &#125;.then &#123;  downloadLink -&gt; <span class="type">Promise</span>&lt;<span class="type">URL</span>&gt; <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> imageLoader.downloadImage(url: downloadLink)</span><br><span class="line">    &#125;.then &#123;downloadedURL -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">self</span>.updateImageAtURL(url: downloadedURL)</span><br><span class="line">    &#125;.<span class="keyword">catch</span> &#123; error <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Error \(error)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>A feature that I find very interesting in both frameworks, Bolts and PromiseKit, is that they allow our code run on a given thread (Main thread or background thread). This is a great feature as most of the work done in the view controller has been to update the UI. Sometimes, long-running tasks are best handled on a background thread, so as not to tie up the UI. For more details about this Thread feature, please refer to their documents: <em>#Threading</em></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Since I am working on CoreBluetooth, I often have to work with async methods. Too many callbacks make my project more difficult to understand and difficult to debug if errors occur. <code>Promise</code> make my code become a more beautiful girl ;).<br>You can download the fully finished sample project <a href="https://github.com/uynguyen/Asynchronous-In-Swift" target="_blank" rel="noopener">here</a>.<br>Feel free to leave out your comments on my post.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://uynguyen.github.io/2018/01/16/Asynchronous-Programming-in-Swift/" data-id="clu3nvc5o0004xzvqgpvsdrvx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/" rel="tag">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Play Central And Peripheral Roles With CoreBluetooth
        
      </div>
    </a>
  
  
    <a href="/2018/01/04/Grand-Central-Dispatch-in-Swift/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Grand Central Dispatch in Swift</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Appclip/" rel="tag">Appclip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BLE/" rel="tag">BLE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bluetooth/" rel="tag">Bluetooth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Books/" rel="tag">Books</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocoa/" rel="tag">Cocoa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Concurrency/" rel="tag">Concurrency</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Conference/" rel="tag">Conference</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Core-Data/" rel="tag">Core Data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CoreBluetooh/" rel="tag">CoreBluetooh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CrossPlatform/" rel="tag">CrossPlatform</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design-Patterns/" rel="tag">Design Patterns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DispatchQueue/" rel="tag">DispatchQueue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Memory-management/" rel="tag">Memory management</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notification/" rel="tag">Notification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Objective-C/" rel="tag">Objective-C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Operations/" rel="tag">Operations</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactNative/" rel="tag">ReactNative</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Software-Architecture/" rel="tag">Software Architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Study/" rel="tag">Study</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/" rel="tag">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI/" rel="tag">UI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UIStackView/" rel="tag">UIStackView</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UML/" rel="tag">UML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vendor/" rel="tag">Vendor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WatchOS/" rel="tag">WatchOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Bluetooth/" rel="tag">Web Bluetooth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/books/" rel="tag">books</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iBeacon/" rel="tag">iBeacon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macOS/" rel="tag">macOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/study/" rel="tag">study</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 11.67px;">Android</a> <a href="/tags/Appclip/" style="font-size: 10px;">Appclip</a> <a href="/tags/BLE/" style="font-size: 18.33px;">BLE</a> <a href="/tags/Bluetooth/" style="font-size: 13.33px;">Bluetooth</a> <a href="/tags/Books/" style="font-size: 10px;">Books</a> <a href="/tags/Cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/Concurrency/" style="font-size: 15px;">Concurrency</a> <a href="/tags/Conference/" style="font-size: 10px;">Conference</a> <a href="/tags/Core-Data/" style="font-size: 10px;">Core Data</a> <a href="/tags/CoreBluetooh/" style="font-size: 11.67px;">CoreBluetooh</a> <a href="/tags/CrossPlatform/" style="font-size: 10px;">CrossPlatform</a> <a href="/tags/Design-Patterns/" style="font-size: 10px;">Design Patterns</a> <a href="/tags/DispatchQueue/" style="font-size: 10px;">DispatchQueue</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Memory-management/" style="font-size: 10px;">Memory management</a> <a href="/tags/Notification/" style="font-size: 11.67px;">Notification</a> <a href="/tags/Objective-C/" style="font-size: 10px;">Objective-C</a> <a href="/tags/Operations/" style="font-size: 11.67px;">Operations</a> <a href="/tags/ReactNative/" style="font-size: 10px;">ReactNative</a> <a href="/tags/Software-Architecture/" style="font-size: 10px;">Software Architecture</a> <a href="/tags/Study/" style="font-size: 11.67px;">Study</a> <a href="/tags/Swift/" style="font-size: 16.67px;">Swift</a> <a href="/tags/UI/" style="font-size: 10px;">UI</a> <a href="/tags/UIStackView/" style="font-size: 10px;">UIStackView</a> <a href="/tags/UML/" style="font-size: 10px;">UML</a> <a href="/tags/Vendor/" style="font-size: 10px;">Vendor</a> <a href="/tags/WatchOS/" style="font-size: 10px;">WatchOS</a> <a href="/tags/Web-Bluetooth/" style="font-size: 10px;">Web Bluetooth</a> <a href="/tags/books/" style="font-size: 10px;">books</a> <a href="/tags/iBeacon/" style="font-size: 11.67px;">iBeacon</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/macOS/" style="font-size: 10px;">macOS</a> <a href="/tags/study/" style="font-size: 10px;">study</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/06/30/Best-practice-iOS-vs-Android-Bluetooth/">Best practice: iOS vs Android Bluetooth</a>
          </li>
        
          <li>
            <a href="/2024/03/23/Core-Bluetooth-on-WatchOS/">Core Bluetooth on WatchOS</a>
          </li>
        
          <li>
            <a href="/2024/01/12/Protobuf/">Protobuf In Practice</a>
          </li>
        
          <li>
            <a href="/2023/11/09/What-s-new-of-Appclip-on-iOS-17/">What&#39;s new of Appclip on iOS 17?</a>
          </li>
        
          <li>
            <a href="/2023/07/22/Schedule-task-in-background-from-foreground-service/">Schedule task in background from foreground service</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 Uy Nguyen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>