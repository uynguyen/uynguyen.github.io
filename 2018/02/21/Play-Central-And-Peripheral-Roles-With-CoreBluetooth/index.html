<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Play Central And Peripheral Roles With CoreBluetooth | Uy Nguyen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="IntroductionAs I mentioned in the previous post, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid dev">
<meta property="og:type" content="article">
<meta property="og:title" content="Play Central And Peripheral Roles With CoreBluetooth">
<meta property="og:url" content="https://uynguyen.github.io/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/index.html">
<meta property="og:site_name" content="Uy Nguyen">
<meta property="og:description" content="IntroductionAs I mentioned in the previous post, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid dev">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/UUIDGen.png">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Peripheral_Result.png">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Scan_Devices.png">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Paring_Request.png">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Demo.gif">
<meta property="og:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Programming_Flow_BLE.png">
<meta property="article:published_time" content="2018-02-21T14:01:26.000Z">
<meta property="article:modified_time" content="2024-03-23T03:54:36.082Z">
<meta property="article:author" content="Uy Nguyen">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="BLE">
<meta property="article:tag" content="CoreBluetooh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Uy Nguyen" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Uy Nguyen</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Be a Software Engineer, not a Coder.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://uynguyen.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Play-Central-And-Peripheral-Roles-With-CoreBluetooth" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/" class="article-date">
  <time datetime="2018-02-21T14:01:26.000Z" itemprop="datePublished">2018-02-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Play Central And Peripheral Roles With CoreBluetooth
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><img src="/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg" alt="" title="I love CoreBluetooth"><br>As I mentioned in <a href="/2017/10/13/Bluetooth-Low-Energy-On-iOS/">the previous post</a>, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid devices.<br>There are two roles to play in the CoreBluetooth concepts: Central and peripheral.</p>
<ul>
<li>Central: Obtain data from peripherals.</li>
<li>Peripheral: Publish data to be accessed by a central. We can make a Bluetooth device plays as a peripheral from either firmware-side or software-side.</li>
</ul>
<p>In this post, I will show you how to create a peripheral by using our own identifiers. Also using another device, as a central, to connect and explore our services. Let’s get it started.</p>
<a id="more"></a> 
<h2 id="Set-up-a-Peripheral"><a href="#Set-up-a-Peripheral" class="headerlink" title="Set up a Peripheral"></a>Set up a Peripheral</h2><p>To create a service, you need to have a unique identifier called UUID. A standard service has a 16-bit UUID and a custom service has a 128-bit UUID. Go ahead and type the following command to generate a unique uuid from your terminal.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ uuidgen</span><br></pre></td></tr></table></figure>
<p><img src="/Post-Resources/PlayRolesInCoreBluetooth/UUIDGen.png" alt=""></p>
<p>As you can see, the command returns an uuid in hexa format (128 bit): <code>A56E51F3-AFFE-4E14-87A2-54927B22354C</code>. We will use this string to set up our own service.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">CBPeripheralManagerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> kServiceUUID = <span class="string">"A56E51F3-AFFE-4E14-87A2-54927B22354C"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Other properties</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidAppear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line">        peripheralManager = <span class="type">CBPeripheralManager</span>(delegate: <span class="keyword">self</span>, queue: <span class="literal">nil</span>)  [<span class="number">1</span>] </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">peripheralManagerDidUpdateState</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"peripheralManagerDidUpdateState \(peripheral.state.rawValue)"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> peripheral.state == .poweredOn &#123;</span><br><span class="line">            <span class="keyword">let</span> serviceUUID = <span class="type">CBUUID</span>(string: kServiceUUID) [<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">self</span>.service = <span class="type">CBMutableService</span>(type: serviceUUID, primary: <span class="literal">true</span>) [<span class="number">3</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Other code</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here is what these methods do:</p>
<ul>
<li>[1] You create an instance of <code>PeripheralManager</code> class, which will play as a peripheral in our example. Note that there is a <code>queue</code> param in the constructor. The events of the peripheral role will be dispatched on the provided queue. If we pass <code>nil</code>, the main queue will be used.</li>
<li>[2] To set up a service, we need to create an instance of <code>CBUUID</code> class. The constructor gets a unique uuid as a param, which differentiates our service among others.</li>
<li>[3] We create an instance of <code>CBMutableService</code> class. The constructor receives two params: The first one is our unique uuid, which was defined at [2]; the second param indicates that whether our service is primary or not. If not, our service will not be found when the app is in the background.</li>
</ul>
<p>Note that you can add services as many as you want. To be simple, I only create one service in this post.<br>OK, let’s move to the next step. We will define characteristics for our service by using the below code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> characteristic = <span class="type">CBMutableCharacteristic</span>.<span class="keyword">init</span>(</span><br><span class="line">    type: <span class="type">CBUUID</span>(string: kCharacteristicUUID), [<span class="number">1</span>]</span><br><span class="line">    properties: [.read, .write, .notify], [<span class="number">2</span>]</span><br><span class="line">    value: <span class="literal">nil</span>, [<span class="number">3</span>]</span><br><span class="line">    permissions: [<span class="type">CBAttributePermissions</span>.readable, <span class="type">CBAttributePermissions</span>.writeable]) [<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>Here is what’s going on:</p>
<ul>
<li>[1] Like a service, a characteristic also needs a unique uuid to be differentiated among others.</li>
<li>[2] We set up properties for the char. There is a variety of characteristic permissions, but I often use some of them:<ul>
<li><em>Read</em>: Used for characteristics that don’t change very often, e.g version number.</li>
<li><em>Write</em>: Modify the value of the characteristic.</li>
<li><em>Indicate and notify</em>: The peripheral continuously notify the updated value of the characteristic to the central. The central does not have to constantly ask for it.</li>
<li><em>IndicateEncryptionRequired</em>: Only trusted devices can enable indications of the characteristic value.<br>For other properties, please refer to <a href="https://developer.apple.com/documentation/corebluetooth/cbcharacteristicproperties" target="_blank" rel="noopener">Apple document</a></li>
</ul>
</li>
<li>[3] The value of the characteristic.</li>
</ul>
<p><em>Important note:</em> If you provide a value for a characteristic, the characteristic must be read-only. Otherwise, you will get a run-time exception look like.<br><code>2018-03-03 12:48:32.938615+0700 Peripheral[4238:3046876] *** Terminating app due to uncaught exception &#39;NSInternalInconsistencyException&#39;, reason: &#39;Characteristics with cached values must be read-only&#39;</code><br>Therefore, you must specify the value to be nil if you expect the value to change during the lifetime of the published service (write).</p>
<ul>
<li>[4] All characteristic should include the “readable” permission so that centrals could read its value. If we want a central can send commands to peripherals, we need to set the “writeable” permission to the characteristic.</li>
</ul>
<p>Now we have one service and one characteristic. Let’s publish it.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.service?.characteristics = []</span><br><span class="line"><span class="keyword">self</span>.service?.characteristics?.append(characteristic)</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.peripheralManager.add(<span class="keyword">self</span>.service!)</span><br></pre></td></tr></table></figure>

<p>After adding a service to the peripheral manager, the delegate method <code>peripheralManager(_ peripheral: CBPeripheralManager, didAdd service: CBService, error: Error?)</code> will be called.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManager</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, didAdd service: CBService, error: Error?)</span></span> &#123;</span><br><span class="line">     <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Add service failed: \(error.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Add service succeeded"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We’re almost done, just one more step: Start advertising the peripheral so that it can be found by other centrals.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">peripheralManager.startAdvertising([<span class="type">CBAdvertisementDataLocalNameKey</span>: <span class="string">"TiTan"</span>,</span><br><span class="line">                                    <span class="type">CBAdvertisementDataServiceUUIDsKey</span> : [<span class="keyword">self</span>.service!.uuid]])</span><br></pre></td></tr></table></figure>

<p>After advertising, the delegate method <code>peripheralManagerDidStartAdvertising</code> will be triggered to indicate whether the peripheral did advertise successfully or not.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManagerDidStartAdvertising</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Start advertising failed: \(error.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Start advertising succeeded"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>At this point, we’ve already defined and published our service(s). From now on, the peripheral can be discovered by centrals via CoreBluetooth.</p>
<p><img src="/Post-Resources/PlayRolesInCoreBluetooth/Peripheral_Result.png" alt=""></p>
<h2 id="Set-up-a-Central"><a href="#Set-up-a-Central" class="headerlink" title="Set up a Central"></a>Set up a Central</h2><p>First, we need to create an instance of the <code>CBCentralManager</code> class.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">CBCentralManagerDelegate</span>, <span class="title">UITableViewDelegate</span>, <span class="title">UITableViewDataSource</span>, <span class="title">CBPeripheralDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">        centralManager = <span class="type">CBCentralManager</span>(delegate: <span class="keyword">self</span>, queue: <span class="literal">nil</span>)</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Like a peripheral manager, there is a <code>queue</code> param in the constructor. The events of the central role will be dispatched on the provided queue. If we pass <code>nil</code>, the main queue will be used.<br>We need to wait for the central manager to be ready, then we will start scanning nearby devices.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">centralManagerDidUpdateState</span><span class="params">(<span class="number">_</span> central: CBCentralManager)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"peripheralManagerDidUpdateState \(central.state.rawValue)"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> central.state == .poweredOn &#123;</span><br><span class="line">        <span class="keyword">self</span>.centralManager.scanForPeripherals(withServices: <span class="literal">nil</span>, options: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If it find a peripheral, the delegate method <code>func centralManager(_ central: CBCentralManager, didDiscover peripheral: CBPeripheral, advertisementData: [String : Any], rssi RSSI: NSNumber)</code> will be called.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">centralManager</span><span class="params">(<span class="number">_</span> central: CBCentralManager, didDiscover peripheral: CBPeripheral, advertisementData: [String : <span class="keyword">Any</span>], rssi RSSI: NSNumber)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> name = peripheral.name &#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkIfExisted(name)) &#123;</span><br><span class="line">            <span class="keyword">let</span> tupleDeviceInfo = (device: peripheral, rssi: <span class="type">RSSI</span>)</span><br><span class="line">            <span class="keyword">self</span>.scannedDevices.append(tupleDeviceInfo)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            <span class="keyword">self</span>.tbvScannedDevices.reloadData()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Inside the method, we will check if the peripheral is valid, after that we will add it to the current list, then reload the table view. Note that the RSSI value represents the strength of the transmitting signal. We can estimate the current distance between the central and the peripheral based on the value. The greater the value, the closer the device is.<br>Build and run the project, you will see the list of discovered devices like this.</p>
<img src="/Post-Resources/PlayRolesInCoreBluetooth/Scan_Devices.png" height="500" />

<p>Now, let’s connect to our peripheral (The “Titan” device) by clicking on the corresponding row.<br>Once a connection is made successfully, the delegate method <code>func centralManager(_ central: CBCentralManager, didConnect peripheral: CBPeripheral)</code> will be called. Otherwise, the method <code>centralManager(_ central: CBCentralManager, didFailToConnect peripheral: CBPeripheral, error: Error?)</code> will be triggered.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">centralManager</span><span class="params">(<span class="number">_</span> central: CBCentralManager, didConnect peripheral: CBPeripheral)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.centralManager.stopScan()</span><br><span class="line">    peripheral.delegate = <span class="keyword">self</span></span><br><span class="line">    <span class="keyword">self</span>.peripheral = peripheral</span><br><span class="line">    <span class="keyword">self</span>.peripheral?.discoverServices(<span class="literal">nil</span>) [<span class="number">1</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">centralManager(<span class="number">_</span> central: <span class="type">CBCentralManager</span>, didFailToConnect peripheral: <span class="type">CBPeripheral</span>, error: <span class="type">Error?</span>) &#123;</span><br><span class="line">    <span class="comment">// Fail to connect peripheral</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Notice that after connecting to the peripheral, we need to discover the services of the peripheral to use it ([1]).<br>The delegate method <code>func peripheral(_ peripheral: CBPeripheral, didDiscoverServices error: Error?)</code> will be called after discovering services.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didDiscoverServices error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> err = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"didDiscoverServices fail \(err.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// [1] Start discovering all chars</span></span><br><span class="line">    <span class="keyword">for</span> service <span class="keyword">in</span> (peripheral.services)! &#123;</span><br><span class="line">        peripheral.discoverCharacteristics(<span class="literal">nil</span>, <span class="keyword">for</span>: service)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We did not finish yet =.= After discovering services, we also need to discover all characteristics of the services at [1].<br>Like others, the method <code>func peripheral(_ peripheral: CBPeripheral, didDiscoverCharacteristicsFor service: CBService, error: Error?)</code> will be called after discovering characteristics for a service.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didDiscoverCharacteristicsFor service: CBService, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"didDiscoverCharacteristicsFor Error \(error.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> service.characteristics! &#123;</span><br><span class="line">        <span class="keyword">if</span> char.properties.<span class="built_in">contains</span>(.notify) &#123;</span><br><span class="line">            peripheral.setNotifyValue(<span class="literal">true</span>, <span class="keyword">for</span>: char) [<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, we need to set notify to the characteristic that contains the <code>notify</code> property to receive updates from it. [1]<br>Finally, we’ve done for setting up a connection between the peripheral and the central. Now let’s explore the data.</p>
<h2 id="Read-and-write-data-from-peripheral"><a href="#Read-and-write-data-from-peripheral" class="headerlink" title="Read and write data from peripheral"></a>Read and write data from peripheral</h2><p>You have to specify which characteristic you want to read.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.peripheral?.readValue(<span class="keyword">for</span>: discovererChars[kCharacteristicUUID]!)</span><br></pre></td></tr></table></figure>
<p>From the peripheral side, you will receive a read request inside the method</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManager</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, didReceiveRead request: CBATTRequest)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Read request"</span>)</span><br><span class="line">    request.value = myValue.data(using: .utf8)</span><br><span class="line">    peripheral.respond(to: request, withResult: .success)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>After the peripheral response to read requests, the delegate method <code>func peripheral(_ peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?)</code> will be called from the central side.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="type">String</span>.<span class="keyword">init</span>(data: characteristic.value!, encoding: .utf8)!</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If the value is successfully retrieved, you can access it through the characteristic’s value property, like above.<br>Sometimes we want to write the value of a characteristic, which is writeable. We can write the value to it by calling the peripheral’s <code>writeValue</code> method like this.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.peripheral?.writeValue(data, <span class="keyword">for</span>: discovererChars[kCharacteristicUUID]!, type: .withResponse)</span><br></pre></td></tr></table></figure>
<p>There is an argument called <code>type</code>, you specify what type of write you want to perform. In the example above, the write type is .withResponse, which instructs the peripheral to let your app know whether or not the write succeeds.<br>From the peripheral side, you will receive a write request inside the method</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManager</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, didReceiveWrite requests: [CBATTRequest])</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Write request"</span>)</span><br><span class="line">    peripheral.respond(to: requests[<span class="number">0</span>], withResult: .success)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>After the write request receives the response, the method <code>peripheral(_ peripheral: CBPeripheral, didWriteValueFor characteristic: CBCharacteristic, error: Error?)</code> will be called.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didWriteValueFor characteristic: CBCharacteristic, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> err = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Did write value with error \(err.localizedDescription)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Encypted-characteristic-values"><a href="#Encypted-characteristic-values" class="headerlink" title="Encypted characteristic values"></a>Encypted characteristic values</h2><p>Sometimes we want to secure sensitive data. We can config the appropriate characteristic properties and permissions. Something like this</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> encryptedChar = <span class="type">CBMutableCharacteristic</span>.<span class="keyword">init</span>(</span><br><span class="line">                type: <span class="type">CBUUID</span>(string: kCharacteristicUUID),</span><br><span class="line">                properties: [.read, .notify, .notifyEncryptionRequired],</span><br><span class="line">                value: <span class="literal">nil</span>,</span><br><span class="line">                permissions: [.readable])</span><br></pre></td></tr></table></figure>

<p>By doing this way, we ensure that only trusted devices have permissions to access these data.<br>In my example, once a connection is made, CoreBluetooth tries to pair the peripheral (iPad) with the central (iPhone) to create a secure connection. Both devices will receive an alert indicating that the other device would like to pair. After paring, the central can access to the encrypted characteristic values of the peripheral.</p>
<img src="/Post-Resources/PlayRolesInCoreBluetooth/Paring_Request.png" height="200" />

<h2 id="Some-important-notes"><a href="#Some-important-notes" class="headerlink" title="Some important notes"></a>Some important notes</h2><ul>
<li>The client-server model of BLE is called a <em>publish and subscribe model</em>.</li>
<li>The peripheral only consumes power when it’s advertising its services, or receiving or responding to a central’s request.</li>
<li>You can pass a list of service UUIDs inside the <code>scanForPeripherals</code> method. When you specify a list of service UUIDs, the central manager returns only peripherals that advertise those services, allowing you to scan only for devices that you may be interested in.</li>
<li>You need to grant permissions to let your app uses Bluetooth LE accessory, and acts as a Bluetooth LE accessory for peripheral sides. (Go to project -&gt; Capabilities for setting).</li>
<li>You also need to add one more information property to your info.plist, let’s add an entry with key <code>Privacy - Bluetooth Peripheral Usage Description</code> and value <code>App communicates using CoreBluetooth</code> (Or whatever you want to describe).</li>
</ul>
<h2 id="A-quick-look-to-my-app"><a href="#A-quick-look-to-my-app" class="headerlink" title="A quick look to my app"></a>A quick look to my app</h2><p>Let’s try some light exercise from my example.<br><img src="/Post-Resources/PlayRolesInCoreBluetooth/Demo.gif" height="500" /></p>
<h2 id="Summarize-the-programming-flow-for-BLE"><a href="#Summarize-the-programming-flow-for-BLE" class="headerlink" title="Summarize the programming flow for BLE"></a>Summarize the programming flow for BLE</h2><p>To summarize the general programming workflow of CoreBluetooth on iOS, please take a look at the picture below.</p>
<p><img src="/Post-Resources/PlayRolesInCoreBluetooth/Programming_Flow_BLE.png" alt=""></p>
<h2 id="Final-thoughts"><a href="#Final-thoughts" class="headerlink" title="Final thoughts"></a>Final thoughts</h2><p>In this post, I guided you how to use the CoreBluetooth to create a peripheral as well as how to create a central to connect and obtain data from a peripheral. In the future, we can see that all devices around us are connected together via Bluetooth, towards the IoT world.<br>You can download the completed project of the central <a href="https://github.com/uynguyen/CoreBluetooth_CentralManager" target="_blank" rel="noopener">here</a> or the peripheral <a href="https://github.com/uynguyen/Blog_CoreBluetooth_Peripheral" target="_blank" rel="noopener">here</a>.<br>If you have any questions or comments, feel free to leave it on my post. Any comments are welcome.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>[1] <a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/AboutCoreBluetooth/Introduction.html#//apple_ref/doc/uid/TP40013257-CH1-SW1" target="_blank" rel="noopener">Core Bluetooth Programming Guide from Apple</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://uynguyen.github.io/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/" data-id="clu3nvc5v001uxzvq3luq7mt3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BLE/" rel="tag">BLE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoreBluetooh/" rel="tag">CoreBluetooh</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/02/27/What-is-refactoring/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          What is refactoring?
        
      </div>
    </a>
  
  
    <a href="/2018/01/16/Asynchronous-Programming-in-Swift/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Asynchronous Programming in Swift</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Appclip/" rel="tag">Appclip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BLE/" rel="tag">BLE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bluetooth/" rel="tag">Bluetooth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Books/" rel="tag">Books</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocoa/" rel="tag">Cocoa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Concurrency/" rel="tag">Concurrency</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Conference/" rel="tag">Conference</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Core-Data/" rel="tag">Core Data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CoreBluetooh/" rel="tag">CoreBluetooh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CrossPlatform/" rel="tag">CrossPlatform</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Design-Patterns/" rel="tag">Design Patterns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DispatchQueue/" rel="tag">DispatchQueue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Memory-management/" rel="tag">Memory management</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Notification/" rel="tag">Notification</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Objective-C/" rel="tag">Objective-C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Operations/" rel="tag">Operations</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactNative/" rel="tag">ReactNative</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Software-Architecture/" rel="tag">Software Architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Study/" rel="tag">Study</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/" rel="tag">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI/" rel="tag">UI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UIStackView/" rel="tag">UIStackView</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UML/" rel="tag">UML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vendor/" rel="tag">Vendor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WatchOS/" rel="tag">WatchOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Bluetooth/" rel="tag">Web Bluetooth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/books/" rel="tag">books</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iBeacon/" rel="tag">iBeacon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/" rel="tag">iOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macOS/" rel="tag">macOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/study/" rel="tag">study</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 11.67px;">Android</a> <a href="/tags/Appclip/" style="font-size: 10px;">Appclip</a> <a href="/tags/BLE/" style="font-size: 18.33px;">BLE</a> <a href="/tags/Bluetooth/" style="font-size: 13.33px;">Bluetooth</a> <a href="/tags/Books/" style="font-size: 10px;">Books</a> <a href="/tags/Cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/Concurrency/" style="font-size: 15px;">Concurrency</a> <a href="/tags/Conference/" style="font-size: 10px;">Conference</a> <a href="/tags/Core-Data/" style="font-size: 10px;">Core Data</a> <a href="/tags/CoreBluetooh/" style="font-size: 11.67px;">CoreBluetooh</a> <a href="/tags/CrossPlatform/" style="font-size: 10px;">CrossPlatform</a> <a href="/tags/Design-Patterns/" style="font-size: 10px;">Design Patterns</a> <a href="/tags/DispatchQueue/" style="font-size: 10px;">DispatchQueue</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Memory-management/" style="font-size: 10px;">Memory management</a> <a href="/tags/Notification/" style="font-size: 11.67px;">Notification</a> <a href="/tags/Objective-C/" style="font-size: 10px;">Objective-C</a> <a href="/tags/Operations/" style="font-size: 11.67px;">Operations</a> <a href="/tags/ReactNative/" style="font-size: 10px;">ReactNative</a> <a href="/tags/Software-Architecture/" style="font-size: 10px;">Software Architecture</a> <a href="/tags/Study/" style="font-size: 11.67px;">Study</a> <a href="/tags/Swift/" style="font-size: 16.67px;">Swift</a> <a href="/tags/UI/" style="font-size: 10px;">UI</a> <a href="/tags/UIStackView/" style="font-size: 10px;">UIStackView</a> <a href="/tags/UML/" style="font-size: 10px;">UML</a> <a href="/tags/Vendor/" style="font-size: 10px;">Vendor</a> <a href="/tags/WatchOS/" style="font-size: 10px;">WatchOS</a> <a href="/tags/Web-Bluetooth/" style="font-size: 10px;">Web Bluetooth</a> <a href="/tags/books/" style="font-size: 10px;">books</a> <a href="/tags/iBeacon/" style="font-size: 11.67px;">iBeacon</a> <a href="/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/tags/macOS/" style="font-size: 10px;">macOS</a> <a href="/tags/study/" style="font-size: 10px;">study</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/06/30/Best-practice-iOS-vs-Android-Bluetooth/">Best practice: iOS vs Android Bluetooth</a>
          </li>
        
          <li>
            <a href="/2024/03/23/Core-Bluetooth-on-WatchOS/">Core Bluetooth on WatchOS</a>
          </li>
        
          <li>
            <a href="/2024/01/12/Protobuf/">Protobuf In Practice</a>
          </li>
        
          <li>
            <a href="/2023/11/09/What-s-new-of-Appclip-on-iOS-17/">What&#39;s new of Appclip on iOS 17?</a>
          </li>
        
          <li>
            <a href="/2023/07/22/Schedule-task-in-background-from-foreground-service/">Schedule task in background from foreground service</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 Uy Nguyen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>