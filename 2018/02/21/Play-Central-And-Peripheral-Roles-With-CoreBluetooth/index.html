<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Play Central And Peripheral Roles With CoreBluetooth - Uy Nguyen</title><meta description="IntroductionAs I mentioned in the previous post, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid dev"><meta property="og:type" content="blog"><meta property="og:title" content="Play Central And Peripheral Roles With CoreBluetooth"><meta property="og:url" content=":year/:month/:day/:title/"><meta property="og:site_name" content="Uy Nguyen"><meta property="og:description" content="IntroductionAs I mentioned in the previous post, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid dev"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2018-02-21T14:01:26.000Z"><meta property="article:modified_time" content="2020-04-13T14:33:02.959Z"><meta property="article:author" content="Uy Nguyen"><meta property="article:tag" content="iOS"><meta property="article:tag" content="CoreBluetooh"><meta property="article:tag" content="BLE"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://uynguyen.github.io/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/"},"headline":"Uy Nguyen","image":["https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg","https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/UUIDGen.png","https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Peripheral_Result.png","https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Scan_Devices.png","https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Paring_Request.png","https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Demo.gif","https://uynguyen.github.io/Post-Resources/PlayRolesInCoreBluetooth/Programming_Flow_BLE.png"],"datePublished":"2018-02-21T14:01:26.000Z","dateModified":"2020-04-13T14:33:02.959Z","author":{"@type":"Person","name":"Uy Nguyen"},"description":"IntroductionAs I mentioned in the previous post, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid dev"}</script><link rel="canonical" href="https://uynguyen.github.io/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/"><link rel="icon" href="/Post-Resources/UyNguyen.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><meta property="og:image" content="/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-163508356-1" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-163508356-1');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/Post-Resources/UyNguyen.jpg" alt="Uy Nguyen" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-02-21T14:01:26.000Z" title="2018-02-21T14:01:26.000Z">2018-02-21</time><span class="level-item">14 minutes read (About 2090 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Play Central And Peripheral Roles With CoreBluetooth</h1><div class="content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><img src="/Post-Resources/PlayRolesInCoreBluetooth/Banner.jpg" alt="" title="I love CoreBluetooth"><br>As I mentioned in <a href="/2017/10/13/Bluetooth-Low-Energy-On-iOS/">the previous post</a>, CoreBluetooth allows us to create applications that can communicate with BLE devices such as heart rate monitors, body sensors, trackers, or hybrid devices.<br>There are two roles to play in the CoreBluetooth concepts: Central and peripheral.</p>
<ul>
<li>Central: Obtain data from peripherals.</li>
<li>Peripheral: Publish data to be accessed by a central. We can make a Bluetooth device plays as a peripheral from either firmware-side or software-side.</li>
</ul>
<p>In this post, I will show you how to create a peripheral by using our own identifiers. Also using another device, as a central, to connect and explore our services. Let’s get it started.</p>
<a id="more"></a> 
<h2 id="Set-up-a-Peripheral"><a href="#Set-up-a-Peripheral" class="headerlink" title="Set up a Peripheral"></a>Set up a Peripheral</h2><p>To create a service, you need to have a unique identifier called UUID. A standard service has a 16-bit UUID and a custom service has a 128-bit UUID. Go ahead and type the following command to generate a unique uuid from your terminal.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ uuidgen</span><br></pre></td></tr></table></figure>
<p><img src="/Post-Resources/PlayRolesInCoreBluetooth/UUIDGen.png" alt=""></p>
<p>As you can see, the command returns an uuid in hexa format (128 bit): <code>A56E51F3-AFFE-4E14-87A2-54927B22354C</code>. We will use this string to set up our own service.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">CBPeripheralManagerDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> kServiceUUID = <span class="string">"A56E51F3-AFFE-4E14-87A2-54927B22354C"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Other properties</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidAppear</span><span class="params">(<span class="number">_</span> animated: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line">        peripheralManager = <span class="type">CBPeripheralManager</span>(delegate: <span class="keyword">self</span>, queue: <span class="literal">nil</span>)  [<span class="number">1</span>] </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">peripheralManagerDidUpdateState</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"peripheralManagerDidUpdateState \(peripheral.state.rawValue)"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> peripheral.state == .poweredOn &#123;</span><br><span class="line">            <span class="keyword">let</span> serviceUUID = <span class="type">CBUUID</span>(string: kServiceUUID) [<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">self</span>.service = <span class="type">CBMutableService</span>(type: serviceUUID, primary: <span class="literal">true</span>) [<span class="number">3</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Other code</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here is what these methods do:</p>
<ul>
<li>[1] You create an instance of <code>PeripheralManager</code> class, which will play as a peripheral in our example. Note that there is a <code>queue</code> param in the constructor. The events of the peripheral role will be dispatched on the provided queue. If we pass <code>nil</code>, the main queue will be used.</li>
<li>[2] To set up a service, we need to create an instance of <code>CBUUID</code> class. The constructor gets a unique uuid as a param, which differentiates our service among others.</li>
<li>[3] We create an instance of <code>CBMutableService</code> class. The constructor receives two params: The first one is our unique uuid, which was defined at [2]; the second param indicates that whether our service is primary or not. If not, our service will not be found when the app is in the background.</li>
</ul>
<p>Note that you can add services as many as you want. To be simple, I only create one service in this post.<br>OK, let’s move to the next step. We will define characteristics for our service by using the below code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> characteristic = <span class="type">CBMutableCharacteristic</span>.<span class="keyword">init</span>(</span><br><span class="line">    type: <span class="type">CBUUID</span>(string: kCharacteristicUUID), [<span class="number">1</span>]</span><br><span class="line">    properties: [.read, .write, .notify], [<span class="number">2</span>]</span><br><span class="line">    value: <span class="literal">nil</span>, [<span class="number">3</span>]</span><br><span class="line">    permissions: [<span class="type">CBAttributePermissions</span>.readable, <span class="type">CBAttributePermissions</span>.writeable]) [<span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>Here is what’s going on:</p>
<ul>
<li>[1] Like a service, a characteristic also needs a unique uuid to be differentiated among others.</li>
<li>[2] We set up properties for the char. There is a variety of characteristic permissions, but I often use some of them:<ul>
<li><em>Read</em>: Used for characteristics that don’t change very often, e.g version number.</li>
<li><em>Write</em>: Modify the value of the characteristic.</li>
<li><em>Indicate and notify</em>: The peripheral continuously notify the updated value of the characteristic to the central. The central does not have to constantly ask for it.</li>
<li><em>IndicateEncryptionRequired</em>: Only trusted devices can enable indications of the characteristic value.<br>For other properties, please refer to <a href="https://developer.apple.com/documentation/corebluetooth/cbcharacteristicproperties">Apple document</a></li>
</ul>
</li>
<li>[3] The value of the characteristic.</li>
</ul>
<p><em>Important note:</em> If you provide a value for a characteristic, the characteristic must be read-only. Otherwise, you will get a run-time exception look like.<br><code>2018-03-03 12:48:32.938615+0700 Peripheral[4238:3046876] *** Terminating app due to uncaught exception &#39;NSInternalInconsistencyException&#39;, reason: &#39;Characteristics with cached values must be read-only&#39;</code><br>Therefore, you must specify the value to be nil if you expect the value to change during the lifetime of the published service (write).</p>
<ul>
<li>[4] All characteristic should include the “readable” permission so that centrals could read its value. If we want a central can send commands to peripherals, we need to set the “writeable” permission to the characteristic.</li>
</ul>
<p>Now we have one service and one characteristic. Let’s publish it.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.service?.characteristics = []</span><br><span class="line"><span class="keyword">self</span>.service?.characteristics?.append(characteristic)</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.peripheralManager.add(<span class="keyword">self</span>.service!)</span><br></pre></td></tr></table></figure>

<p>After adding a service to the peripheral manager, the delegate method <code>peripheralManager(_ peripheral: CBPeripheralManager, didAdd service: CBService, error: Error?)</code> will be called.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManager</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, didAdd service: CBService, error: Error?)</span></span> &#123;</span><br><span class="line">     <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Add service failed: \(error.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Add service succeeded"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We’re almost done, just one more step: Start advertising the peripheral so that it can be found by other centrals.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">peripheralManager.startAdvertising([<span class="type">CBAdvertisementDataLocalNameKey</span>: <span class="string">"TiTan"</span>,</span><br><span class="line">                                    <span class="type">CBAdvertisementDataServiceUUIDsKey</span> : [<span class="keyword">self</span>.service!.uuid]])</span><br></pre></td></tr></table></figure>

<p>After advertising, the delegate method <code>peripheralManagerDidStartAdvertising</code> will be triggered to indicate whether the peripheral did advertise successfully or not.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManagerDidStartAdvertising</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Start advertising failed: \(error.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Start advertising succeeded"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>At this point, we’ve already defined and published our service(s). From now on, the peripheral can be discovered by centrals via CoreBluetooth.</p>
<p><img src="/Post-Resources/PlayRolesInCoreBluetooth/Peripheral_Result.png" alt=""></p>
<h2 id="Set-up-a-Central"><a href="#Set-up-a-Central" class="headerlink" title="Set up a Central"></a>Set up a Central</h2><p>First, we need to create an instance of the <code>CBCentralManager</code> class.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span>, <span class="title">CBCentralManagerDelegate</span>, <span class="title">UITableViewDelegate</span>, <span class="title">UITableViewDataSource</span>, <span class="title">CBPeripheralDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        <span class="comment">// Do any additional setup after loading the view, typically from a nib.</span></span><br><span class="line">        centralManager = <span class="type">CBCentralManager</span>(delegate: <span class="keyword">self</span>, queue: <span class="literal">nil</span>)</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Like a peripheral manager, there is a <code>queue</code> param in the constructor. The events of the central role will be dispatched on the provided queue. If we pass <code>nil</code>, the main queue will be used.<br>We need to wait for the central manager to be ready, then we will start scanning nearby devices.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">centralManagerDidUpdateState</span><span class="params">(<span class="number">_</span> central: CBCentralManager)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"peripheralManagerDidUpdateState \(central.state.rawValue)"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> central.state == .poweredOn &#123;</span><br><span class="line">        <span class="keyword">self</span>.centralManager.scanForPeripherals(withServices: <span class="literal">nil</span>, options: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If it find a peripheral, the delegate method <code>func centralManager(_ central: CBCentralManager, didDiscover peripheral: CBPeripheral, advertisementData: [String : Any], rssi RSSI: NSNumber)</code> will be called.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">centralManager</span><span class="params">(<span class="number">_</span> central: CBCentralManager, didDiscover peripheral: CBPeripheral, advertisementData: [String : <span class="keyword">Any</span>], rssi RSSI: NSNumber)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> name = peripheral.name &#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkIfExisted(name)) &#123;</span><br><span class="line">            <span class="keyword">let</span> tupleDeviceInfo = (device: peripheral, rssi: <span class="type">RSSI</span>)</span><br><span class="line">            <span class="keyword">self</span>.scannedDevices.append(tupleDeviceInfo)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            <span class="keyword">self</span>.tbvScannedDevices.reloadData()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Inside the method, we will check if the peripheral is valid, after that we will add it to the current list, then reload the table view. Note that the RSSI value represents the strength of the transmitting signal. We can estimate the current distance between the central and the peripheral based on the value. The greater the value, the closer the device is.<br>Build and run the project, you will see the list of discovered devices like this.</p>
<img src="/Post-Resources/PlayRolesInCoreBluetooth/Scan_Devices.png" height="500" />

<p>Now, let’s connect to our peripheral (The “Titan” device) by clicking on the corresponding row.<br>Once a connection is made successfully, the delegate method <code>func centralManager(_ central: CBCentralManager, didConnect peripheral: CBPeripheral)</code> will be called. Otherwise, the method <code>centralManager(_ central: CBCentralManager, didFailToConnect peripheral: CBPeripheral, error: Error?)</code> will be triggered.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">centralManager</span><span class="params">(<span class="number">_</span> central: CBCentralManager, didConnect peripheral: CBPeripheral)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.centralManager.stopScan()</span><br><span class="line">    peripheral.delegate = <span class="keyword">self</span></span><br><span class="line">    <span class="keyword">self</span>.peripheral = peripheral</span><br><span class="line">    <span class="keyword">self</span>.peripheral?.discoverServices(<span class="literal">nil</span>) [<span class="number">1</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">centralManager(<span class="number">_</span> central: <span class="type">CBCentralManager</span>, didFailToConnect peripheral: <span class="type">CBPeripheral</span>, error: <span class="type">Error?</span>) &#123;</span><br><span class="line">    <span class="comment">// Fail to connect peripheral</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Notice that after connecting to the peripheral, we need to discover the services of the peripheral to use it ([1]).<br>The delegate method <code>func peripheral(_ peripheral: CBPeripheral, didDiscoverServices error: Error?)</code> will be called after discovering services.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didDiscoverServices error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> err = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"didDiscoverServices fail \(err.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// [1] Start discovering all chars</span></span><br><span class="line">    <span class="keyword">for</span> service <span class="keyword">in</span> (peripheral.services)! &#123;</span><br><span class="line">        peripheral.discoverCharacteristics(<span class="literal">nil</span>, <span class="keyword">for</span>: service)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We did not finish yet =.= After discovering services, we also need to discover all characteristics of the services at [1].<br>Like others, the method <code>func peripheral(_ peripheral: CBPeripheral, didDiscoverCharacteristicsFor service: CBService, error: Error?)</code> will be called after discovering characteristics for a service.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didDiscoverCharacteristicsFor service: CBService, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"didDiscoverCharacteristicsFor Error \(error.localizedDescription)"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> service.characteristics! &#123;</span><br><span class="line">        <span class="keyword">if</span> char.properties.<span class="built_in">contains</span>(.notify) &#123;</span><br><span class="line">            peripheral.setNotifyValue(<span class="literal">true</span>, <span class="keyword">for</span>: char) [<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, we need to set notify to the characteristic that contains the <code>notify</code> property to receive updates from it. [1]<br>Finally, we’ve done for setting up a connection between the peripheral and the central. Now let’s explore the data.</p>
<h2 id="Read-and-write-data-from-peripheral"><a href="#Read-and-write-data-from-peripheral" class="headerlink" title="Read and write data from peripheral"></a>Read and write data from peripheral</h2><p>You have to specify which characteristic you want to read.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.peripheral?.readValue(<span class="keyword">for</span>: discovererChars[kCharacteristicUUID]!)</span><br></pre></td></tr></table></figure>
<p>From the peripheral side, you will receive a read request inside the method</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManager</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, didReceiveRead request: CBATTRequest)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Read request"</span>)</span><br><span class="line">    request.value = myValue.data(using: .utf8)</span><br><span class="line">    peripheral.respond(to: request, withResult: .success)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>After the peripheral response to read requests, the delegate method <code>func peripheral(_ peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?)</code> will be called from the central side.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didUpdateValueFor characteristic: CBCharacteristic, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="type">String</span>.<span class="keyword">init</span>(data: characteristic.value!, encoding: .utf8)!</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If the value is successfully retrieved, you can access it through the characteristic’s value property, like above.<br>Sometimes we want to write the value of a characteristic, which is writeable. We can write the value to it by calling the peripheral’s <code>writeValue</code> method like this.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.peripheral?.writeValue(data, <span class="keyword">for</span>: discovererChars[kCharacteristicUUID]!, type: .withResponse)</span><br></pre></td></tr></table></figure>
<p>There is an argument called <code>type</code>, you specify what type of write you want to perform. In the example above, the write type is .withResponse, which instructs the peripheral to let your app know whether or not the write succeeds.<br>From the peripheral side, you will receive a write request inside the method</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheralManager</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheralManager, didReceiveWrite requests: [CBATTRequest])</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Write request"</span>)</span><br><span class="line">    peripheral.respond(to: requests[<span class="number">0</span>], withResult: .success)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>After the write request receives the response, the method <code>peripheral(_ peripheral: CBPeripheral, didWriteValueFor characteristic: CBCharacteristic, error: Error?)</code> will be called.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peripheral</span><span class="params">(<span class="number">_</span> peripheral: CBPeripheral, didWriteValueFor characteristic: CBCharacteristic, error: Error?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> err = error &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Did write value with error \(err.localizedDescription)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Encypted-characteristic-values"><a href="#Encypted-characteristic-values" class="headerlink" title="Encypted characteristic values"></a>Encypted characteristic values</h2><p>Sometimes we want to secure sensitive data. We can config the appropriate characteristic properties and permissions. Something like this</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> encryptedChar = <span class="type">CBMutableCharacteristic</span>.<span class="keyword">init</span>(</span><br><span class="line">                type: <span class="type">CBUUID</span>(string: kCharacteristicUUID),</span><br><span class="line">                properties: [.read, .notify, .notifyEncryptionRequired],</span><br><span class="line">                value: <span class="literal">nil</span>,</span><br><span class="line">                permissions: [.readable])</span><br></pre></td></tr></table></figure>

<p>By doing this way, we ensure that only trusted devices have permissions to access these data.<br>In my example, once a connection is made, CoreBluetooth tries to pair the peripheral (iPad) with the central (iPhone) to create a secure connection. Both devices will receive an alert indicating that the other device would like to pair. After paring, the central can access to the encrypted characteristic values of the peripheral.</p>
<img src="/Post-Resources/PlayRolesInCoreBluetooth/Paring_Request.png" height="200" />

<h2 id="Some-important-notes"><a href="#Some-important-notes" class="headerlink" title="Some important notes"></a>Some important notes</h2><ul>
<li>The client-server model of BLE is called a <em>publish and subscribe model</em>.</li>
<li>The peripheral only consumes power when it’s advertising its services, or receiving or responding to a central’s request.</li>
<li>You can pass a list of service UUIDs inside the <code>scanForPeripherals</code> method. When you specify a list of service UUIDs, the central manager returns only peripherals that advertise those services, allowing you to scan only for devices that you may be interested in.</li>
<li>You need to grant permissions to let your app uses Bluetooth LE accessory, and acts as a Bluetooth LE accessory for peripheral sides. (Go to project -&gt; Capabilities for setting).</li>
<li>You also need to add one more information property to your info.plist, let’s add an entry with key <code>Privacy - Bluetooth Peripheral Usage Description</code> and value <code>App communicates using CoreBluetooth</code> (Or whatever you want to describe).</li>
</ul>
<h2 id="A-quick-look-to-my-app"><a href="#A-quick-look-to-my-app" class="headerlink" title="A quick look to my app"></a>A quick look to my app</h2><p>Let’s try some light exercise from my example.<br><img src="/Post-Resources/PlayRolesInCoreBluetooth/Demo.gif" height="500" /></p>
<h2 id="Summarize-the-programming-flow-for-BLE"><a href="#Summarize-the-programming-flow-for-BLE" class="headerlink" title="Summarize the programming flow for BLE"></a>Summarize the programming flow for BLE</h2><p>To summarize the general programming workflow of CoreBluetooth on iOS, please take a look at the picture below.</p>
<p><img src="/Post-Resources/PlayRolesInCoreBluetooth/Programming_Flow_BLE.png" alt=""></p>
<h2 id="Final-thoughts"><a href="#Final-thoughts" class="headerlink" title="Final thoughts"></a>Final thoughts</h2><p>In this post, I guided you how to use the CoreBluetooth to create a peripheral as well as how to create a central to connect and obtain data from a peripheral. In the future, we can see that all devices around us are connected together via Bluetooth, towards the IoT world.<br>You can download the completed project of the central <a href="https://github.com/uynguyen/CoreBluetooth_CentralManager">here</a> or the peripheral <a href="https://github.com/uynguyen/Blog_CoreBluetooth_Peripheral">here</a>.<br>If you have any questions or comments, feel free to leave it on my post. Any comments are welcome.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>[1] <a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/AboutCoreBluetooth/Introduction.html#//apple_ref/doc/uid/TP40013257-CH1-SW1">Core Bluetooth Programming Guide from Apple</a></p>
</div><div class="article-tags size-small is-uppercase mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/iOS/">iOS</a><a class="link-muted mr-2" rel="tag" href="/tags/CoreBluetooh/">CoreBluetooh</a><a class="link-muted mr-2" rel="tag" href="/tags/BLE/">BLE</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=5e9474199d6bcc0012d5bba6&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="https://ko-fi.com/uynguyen" style="background-color:rgba(255,128,62,.87);border-color:transparent;color:white;" target="_blank" rel="noopener"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button is-warning donate" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="uynguyen.itus@gmail.com"><input type="hidden" name="currency_code" value="USD"></form></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2018/02/27/What-is-refactoring/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">What is refactoring?</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2018/01/16/Asynchronous-Programming-in-Swift/"><span class="level-item">Asynchronous Programming in Swift</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://uynguyen.github.io/2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/';
            this.page.identifier = '2018/02/21/Play-Central-And-Peripheral-Roles-With-CoreBluetooth/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'uynguyen-github-io' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="/Post-Resources/UyNguyen.jpg" alt="Uy Nguyen"></figure><p class="title is-size-4 is-block line-height-inherit">Uy Nguyen</p><p class="is-size-6 is-block">Software engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Vietnam</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">24</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/uynguyen" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/uynguyen"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/UyNguyen505"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://www.linkedin.com/in/uynguyen505"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://uynguyen.github.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Uy Nguyen</span></span><span class="level-right"><span class="level-item tag">uynguyen.github.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-30T10:02:31.000Z">2020-05-30</time></p><p class="title is-6"><a class="link-muted" href="/2020/05/30/Advanced-iOS-Concurrency-Async-Operations-2/">Advanced iOS Concurrency: Async Operations [2]</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-16T13:54:36.000Z">2020-05-16</time></p><p class="title is-6"><a class="link-muted" href="/2020/05/16/iOS-Concurrency-Operations/">Advanced iOS Concurrency: Operations [1]</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-27T13:56:51.000Z">2020-04-27</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/27/Building-your-personal-page-with-Hexo/">Building your personal page with Hexo</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-14T14:25:25.000Z">2020-04-14</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/14/Beta-Test-and-TestFlight/">Beta Test and TestFlight</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-02-26T15:05:30.000Z">2020-02-26</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/26/Review-book-Swift-Apprentice-Raywenderlich/">Review book: Swift Apprentice - Raywenderlich</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/01/"><span class="level-start"><span class="level-item">January 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/08/"><span class="level-start"><span class="level-item">August 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/07/"><span class="level-start"><span class="level-item">July 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/06/"><span class="level-start"><span class="level-item">June 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/BLE/"><span class="tag">BLE</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cocoa/"><span class="tag">Cocoa</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Concurrency/"><span class="tag">Concurrency</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Conference/"><span class="tag">Conference</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Core-Data/"><span class="tag">Core Data</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CoreBluetooh/"><span class="tag">CoreBluetooh</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CrossPlatform/"><span class="tag">CrossPlatform</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Design-Patterns/"><span class="tag">Design Patterns</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DispatchQueue/"><span class="tag">DispatchQueue</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Memory-management/"><span class="tag">Memory management</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Objective-C/"><span class="tag">Objective-C</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Operations/"><span class="tag">Operations</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ReactNative/"><span class="tag">ReactNative</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Software-Architecture/"><span class="tag">Software Architecture</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Study/"><span class="tag">Study</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Swift/"><span class="tag">Swift</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UML/"><span class="tag">UML</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vendor/"><span class="tag">Vendor</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/books/"><span class="tag">books</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iBeacon/"><span class="tag">iBeacon</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/study/"><span class="tag">study</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/Post-Resources/UyNguyen.jpg" alt="Uy Nguyen" height="28"></a><p class="size-small"><span>&copy; Uy Nguyen</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://uynguyen.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>